const quizQuestions = {
    'pt': [
        {
            question: "Qual característica principal diferencia a arquitetura do iOS (Apple) em comparação com o Android (Google)?",
            options: [
                "iOS utiliza um modelo de código aberto (Open Source), enquanto Android é totalmente fechado.",
                "Android permite customizações extensas de interface e maior sideloading de apps.",
                "O iOS é baseado em Linux, e o Android é baseado em um kernel próprio da Apple.",
                "Android suporta apenas a linguagem Java, enquanto iOS suporta apenas Swift e C#."
            ],
            correctAnswer: "Android permite customizações extensas de interface e maior sideloading de apps."
        },
        {
            question: "Qual foi o assistente virtual pioneiro, lançado pela Apple em 2011, que popularizou a interação por voz em smartphones?",
            options: [
                "Google Assistant",
                "Alexa (Amazon)",
                "Siri",
                "Cortana (Microsoft)"
            ],
            correctAnswer: "Siri"
        },
        {
            question: "Qual conceito fundamental permite que um computador quântico execute um número exponencialmente maior de cálculos simultâneos do que um computador clássico?",
            options: [
                "O uso de transistores de silício ultra-miniaturizados.",
                "O princípio da superposição e o emaranhamento quântico (qubits).",
                "A utilização de linguagens de programação de alto nível como Java e C#.",
                "A troca de chips de memória RAM por armazenamento em nuvem."
            ],
            correctAnswer: "O princípio da superposição e o emaranhamento quântico (qubits)."
        },
        {
            question: "Qual plataforma é amplamente considerada a 'Primeira Rede Social Moderna', lançada em 1997, que permitia criação de perfis e adição de amigos?",
            options: [
                "Friendster",
                "MySpace",
                "SixDegrees",
                "Orkut"
            ],
            correctAnswer: "SixDegrees"
        },
        {
            question: "Qual linguagem de programação, orientada a objetos e desenvolvida pela Microsoft no ano 2000, é influenciada por C++ e Java?",
            options: [
                "Python",
                "C# (C Sharp)",
                "JavaScript",
                "Assembly"
            ],
            correctAnswer: "C# (C Sharp)"
        },
        {
            question: "O período de 2000 a 2010 na Linha do Tempo Tecnológica foi marcado principalmente pelo surgimento e popularização de qual conceito?",
            options: [
                "A Singularidade Tecnológica.",
                "A Era da Inteligência Artificial Generalizada.",
                "A Web 2.0 e o surgimento das Redes Sociais.",
                "A tecnologia de imortalidade digital."
            ],
            correctAnswer: "A Web 2.0 e o surgimento das Redes Sociais."
        },
        {
            question: "Qual avanço tecnológico se tornou padrão no período de 2010 a 2020, permitindo o processamento e análise de volumes massivos de dados?",
            options: [
                "Computação Quântica Comercial.",
                "O domínio dos mainframes (grandes computadores).",
                "A adoção de Big Data e a Computação em Nuvem (Cloud Computing).",
                "A invenção do transistor."
            ],
            correctAnswer: "A adoção de Big Data e a Computação em Nuvem (Cloud Computing)."
        },
        {
            question: "No contexto de Sistemas Operacionais, qual dos seguintes age como a ponte de comunicação fundamental, gerenciando a interação entre o hardware do dispositivo e os aplicativos?",
            options: [
                "O processador (CPU).",
                "A Linguagem de Programação Java.",
                "O próprio Sistema Operacional.",
                "A memória RAM."
            ],
            correctAnswer: "O próprio Sistema Operacional."
        },
        {
            question: "Qual é a principal tecnologia que define a 'Era da Inteligência Artificial Generalizada' (2020 - Atual) e que permite a criação de conteúdo original como texto e imagens?",
            options: [
                "Realidade Virtual (VR).",
                "Inteligência Artificial Generativa (Generative AI).",
                "Blockchain.",
                "Redes 3G."
            ],
            correctAnswer: "Inteligência Artificial Generativa (Generative AI)."
        },
        {
            question: "Em relação ao ecossistema de hardware, a Apple (iOS) costuma oferecer qual vantagem percebida em comparação com a fragmentação de diversos fabricantes no Android?",
            options: [
                "Um custo de hardware significativamente mais baixo.",
                "Maior fragmentação de versões do sistema operacional.",
                "Uma integração mais otimizada e coesa entre software e hardware.",
                "Suporte nativo para a linguagem de programação C#."
            ],
            correctAnswer: "Uma integração mais otimizada e coesa entre software e hardware."
        }
    ],
    'en': [
        {
            question: "What main characteristic differentiates iOS (Apple) architecture compared to Android (Google)?",
            options: [
                "iOS uses an open source model, while Android is completely closed.",
                "Android allows extensive interface customizations and greater app sideloading.",
                "iOS is based on Linux, and Android is based on Apple's own kernel.",
                "Android only supports Java, while iOS only supports Swift and C#."
            ],
            correctAnswer: "Android allows extensive interface customizations and greater app sideloading."
        },
        {
            question: "Which pioneering virtual assistant, launched by Apple in 2011, popularized voice interaction on smartphones?",
            options: [
                "Google Assistant",
                "Alexa (Amazon)",
                "Siri",
                "Cortana (Microsoft)"
            ],
            correctAnswer: "Siri"
        },
        {
            question: "What fundamental concept allows a quantum computer to perform an exponentially greater number of simultaneous calculations than a classical computer?",
            options: [
                "The use of ultra-miniaturized silicon transistors.",
                "The principle of superposition and quantum entanglement (qubits).",
                "The use of high-level programming languages like Java and C#.",
                "The exchange of RAM memory chips for cloud storage."
            ],
            correctAnswer: "The principle of superposition and quantum entanglement (qubits)."
        },
        {
            question: "Which platform is widely considered the 'First Modern Social Media', launched in 1997, that allowed profile creation and friend adding?",
            options: [
                "Friendster",
                "MySpace",
                "SixDegrees",
                "Orkut"
            ],
            correctAnswer: "SixDegrees"
        },
        {
            question: "Which object-oriented programming language, developed by Microsoft in 2000, is influenced by C++ and Java?",
            options: [
                "Python",
                "C# (C Sharp)",
                "JavaScript",
                "Assembly"
            ],
            correctAnswer: "C# (C Sharp)"
        },
        {
            question: "The period from 2000 to 2010 in the Technology Timeline was mainly marked by the emergence and popularization of which concept?",
            options: [
                "The Technological Singularity.",
                "The Era of Generalized Artificial Intelligence.",
                "Web 2.0 and the emergence of Social Media.",
                "Digital immortality technology."
            ],
            correctAnswer: "Web 2.0 and the emergence of Social Media."
        },
        {
            question: "Which technological advancement became standard in the period from 2010 to 2020, allowing the processing and analysis of massive data volumes?",
            options: [
                "Commercial Quantum Computing.",
                "The dominance of mainframes (large computers).",
                "The adoption of Big Data and Cloud Computing.",
                "The invention of the transistor."
            ],
            correctAnswer: "The adoption of Big Data and Cloud Computing."
        },
        {
            question: "In the context of Operating Systems, which of the following acts as the fundamental communication bridge, managing the interaction between device hardware and applications?",
            options: [
                "The processor (CPU).",
                "The Java Programming Language.",
                "The Operating System itself.",
                "The RAM memory."
            ],
            correctAnswer: "The Operating System itself."
        },
        {
            question: "What is the main technology that defines the 'Era of Generalized Artificial Intelligence' (2020 - Present) and allows the creation of original content like text and images?",
            options: [
                "Virtual Reality (VR).",
                "Generative Artificial Intelligence (Generative AI).",
                "Blockchain.",
                "3G Networks."
            ],
            correctAnswer: "Generative Artificial Intelligence (Generative AI)."
        },
        {
            question: "Regarding the hardware ecosystem, what perceived advantage does Apple (iOS) usually offer compared to the fragmentation of various manufacturers in Android?",
            options: [
                "A significantly lower hardware cost.",
                "Greater fragmentation of operating system versions.",
                "A more optimized and cohesive integration between software and hardware.",
                "Native support for the C# programming language."
            ],
            correctAnswer: "A more optimized and cohesive integration between software and hardware."
        }
    ]
};

// Textos da interface por idioma
const interfaceTexts = {
    'pt': {
        quizTitle: "Quiz Nexo",
        questionPrefix: "Pergunta",
        of: "de",
        finalResult: "Resultado Final!",
        finalScore: "Você acertou",
        ofQuestions: "de",
        questions: "perguntas!",
        tryAgain: "Tentar Novamente",
        mistakesTitle: "Onde você errou:",
        question: "Questão",
        yourAnswer: "Sua Resposta:",
        correctAnswer: "Resposta Correta:",
        feedback: {
            perfect: "Parabéns! Conhecimento de Nível NEXO Máximo!",
            excellent: "Excelente! Você domina a maioria dos tópicos tecnológicos!",
            good: "Bom trabalho! Continue explorando nossos conteúdos para melhorar.",
            beginner: "Você está começando! Revise a Linha do Tempo e os tópicos para um próximo nível."
        }
    },
    'en': {
        quizTitle: "Nexo Quiz",
        questionPrefix: "Question",
        of: "of",
        finalResult: "Final Result!",
        finalScore: "You got",
        ofQuestions: "of",
        questions: "questions right!",
        tryAgain: "Try Again",
        mistakesTitle: "Where you went wrong:",
        question: "Question",
        yourAnswer: "Your Answer:",
        correctAnswer: "Correct Answer:",
        feedback: {
            perfect: "Congratulations! Maximum NEXO Level Knowledge!",
            excellent: "Excellent! You master most technology topics!",
            good: "Good work! Continue exploring our content to improve.",
            beginner: "You're just starting! Review the Timeline and topics for the next level."
        }
    }
};

let currentQuestionIndex = 0;
let score = 0;
let questions = [];
let mistakes = []; 
const optionLabels = ['A', 'B', 'C', 'D'];

const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionText = document.getElementById('question-text');
const answerOptionsContainer = document.getElementById('answer-options');
const progressBar = document.getElementById('progress-bar');
const finalScoreText = document.getElementById('final-score');
const feedbackMessage = document.getElementById('feedback-message');
const restartButton = document.getElementById('restart-btn');
const mistakesContainer = document.getElementById('mistakes-container');
const quizTitle = document.querySelector('.question-title');

// Detectar idioma atual
function getCurrentLanguage() {
    const currentFile = window.location.pathname.split('/').pop();
    return currentFile === 'index-en.html' ? 'en' : 'pt';
}

let currentLang = getCurrentLanguage();

function initializeQuiz() {
    questions = [...quizQuestions[currentLang]];
    questions.sort(() => Math.random() - 0.5); 
    
    questions.forEach(q => {
        q.options.sort(() => Math.random() - 0.5);
    });
    
    currentQuestionIndex = 0;
    score = 0;
    mistakes = [];
    
    // Atualizar textos da interface
    quizTitle.textContent = interfaceTexts[currentLang].quizTitle;
    restartButton.textContent = interfaceTexts[currentLang].tryAgain;
    
    quizScreen.classList.remove('d-none');
    resultScreen.classList.add('d-none');
    mistakesContainer.classList.add('d-none');
    
    showQuestion();
}

function updateProgress() {
    const progress = (currentQuestionIndex / questions.length) * 100;
    progressBar.style.width = `${progress}%`;
}

function showQuestion() {
    if (currentQuestionIndex >= questions.length) {
        showResults();
        return;
    }

    const currentQuestion = questions[currentQuestionIndex];
    const texts = interfaceTexts[currentLang];
    
    questionText.textContent = `${texts.questionPrefix} ${currentQuestionIndex + 1} ${texts.of} ${questions.length}: ${currentQuestion.question}`;
    answerOptionsContainer.innerHTML = '';
    
    updateProgress();

    currentQuestion.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.textContent = `${optionLabels[index]}) ${option}`;
        button.setAttribute('data-answer-text', option);
        button.classList.add('answer-option');
        button.classList.add('btn-nexo-text');
        button.addEventListener('click', () => handleAnswer(button, option, currentQuestion.correctAnswer));
        answerOptionsContainer.appendChild(button);
    });
}

function handleAnswer(selectedButton, selectedAnswer, correctAnswer) {
    Array.from(answerOptionsContainer.children).forEach(button => {
        button.classList.add('disabled');
        button.removeEventListener('click', handleAnswer);
    });

    if (selectedAnswer === correctAnswer) {
        selectedButton.classList.add('correct');
        score++;
    } else {
        selectedButton.classList.add('incorrect');
        
        mistakes.push({
            questionNumber: currentQuestionIndex + 1,
            questionText: questions[currentQuestionIndex].question,
            userAnswer: selectedAnswer,
            correctAnswer: correctAnswer
        });
        
        Array.from(answerOptionsContainer.children).forEach(button => {
            if (button.getAttribute('data-answer-text') === correctAnswer) {
                button.classList.add('correct');
            }
        });
    }

    setTimeout(() => {
        currentQuestionIndex++;
        showQuestion();
    }, 1500); 
}

function showResults() {
    updateProgress();
    quizScreen.classList.add('d-none');
    resultScreen.classList.remove('d-none');
    
    const total = questions.length;
    const texts = interfaceTexts[currentLang];
    
    finalScoreText.textContent = `${texts.finalScore} ${score} ${texts.ofQuestions} ${total} ${texts.questions}`;
    
    let feedback = '';
    if (score === total) {
        feedback = texts.feedback.perfect;
    } else if (score >= total * 0.7) {
        feedback = texts.feedback.excellent;
    } else if (score >= total * 0.4) {
        feedback = texts.feedback.good;
    } else {
        feedback = texts.feedback.beginner;
    }
    feedbackMessage.textContent = feedback;
    
    if (mistakes.length > 0) {
        showMistakes();
    }
}

function showMistakes() {
    mistakesContainer.classList.remove('d-none');
    const texts = interfaceTexts[currentLang];
    mistakesContainer.innerHTML = `<h3>${texts.mistakesTitle}</h3>`;
    
    mistakes.forEach(mistake => {
        const mistakeDiv = document.createElement('div');
        mistakeDiv.classList.add('mistake-item', 'mb-4', 'p-3', 'rounded');
        
        mistakeDiv.innerHTML = `
            <p><strong>${texts.question} ${mistake.questionNumber}:</strong> ${mistake.questionText}</p>
            <p class="text-danger">${texts.yourAnswer} ${mistake.userAnswer}</p>
            <p class="text-success">${texts.correctAnswer} ${mistake.correctAnswer}</p>
        `;
        mistakeDiv.style.color = getMistakeTextColor();
        mistakesContainer.appendChild(mistakeDiv);
    });
}

function getMistakeTextColor() {
    const theme = document.documentElement.classList.contains('dark-mode') ? 'dark' : 'light';
    return theme === 'dark' ? '#f0f0f0' : '#333333';
}

restartButton.addEventListener('click', initializeQuiz);

document.addEventListener('DOMContentLoaded', initializeQuiz);